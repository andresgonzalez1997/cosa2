def _is_header_row(row: pd.Series) -> bool:
    combined = " ".join(row.astype(str)).upper()

    if _PRICE_RE.search(combined):
        return True

    first = str(row.iloc[0]).strip().upper()

    # âš¡ Cabeceras tipo "FORMULA CODE / PRODUCT DESC"
    if "FORMULA" in combined and "PRODUCT" in combined:
        return True

    if first and first[0].isdigit():
        return False

    if first.startswith("PRODUCT") and str(row.iloc[1]).upper().startswith("FORMULA"):
        return True

    if pd.isna(row["list_price"]):
        if any(tok in combined for tok in HEADER_TOKENS):
            return True

    return False
