if df.shape[0] > 0:
    raw_name = pathlib.Path(pdf_filename).stem
    base_name = correct_file_name(raw_name)
    print("[DEBUG] Nombre base para el archivo CSV:", base_name)

    # Guardar localmente como CSV
    csv_output_path = os.path.join("output_csv", f"{base_name}.csv")
    os.makedirs("output_csv", exist_ok=True)

    try:
        df.to_csv(csv_output_path, index=False)
        print(f"[INFO] CSV guardado en: {csv_output_path}")
    except Exception as e:
        print(f"[ERROR] Al guardar CSV: {e}")
