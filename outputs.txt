/* ---------- TABLA COMPLETA CON RANK Y ACUMULADO ---------- */
New_Table_Measures =
VAR base =
    /* 1️⃣  Traemos la descripción del producto y la medida “Parameter MM”            */
    SUMMARIZECOLUMNS (
        Struct_MatMst[PROD_DESC],
        "Parameter MM", [Parameter MM]          -- tu medida ya existente
    )

/* 2️⃣  Calculamos el RANK dentro de la misma variable ------- */
VAR baseRank =
    ADDCOLUMNS (
        base,
        "Rankmm",
        RANKX ( base, [Parameter MM], , DESC, DENSE )
    )

/* 3️⃣  Añadimos la columna de acumulado --------------------- */
RETURN
    ADDCOLUMNS (
        baseRank,
        "Parameter MM Acum",
        VAR _currRank = [Rankmm]                -- rank de la fila actual
        RETURN
            CALCULATE (
                SUMX (
                    FILTER ( baseRank, [Rankmm] <= _currRank ),
                    [Parameter MM]
                )
            )
    )