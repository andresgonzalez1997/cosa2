-- 1.Ranking Measure
M_Rank =
RANKX (
    ALLSELECTED ( Struct_MatMst[PROD_DESC] ),   -- ignora sólo el filtro visual,
    [TT Mrgn],                                  -- mide el margen
    ,
    DESC,
    DENSE
)

-- 2. Running Total acumulado por ese ranking
M_Running Total =
VAR _CurrentRank = [M_Rank]          -- capturamos el rango del punto actual
RETURN
CALCULATE (
    [TT Mrgn],                       -- métrica que estamos acumulando
    FILTER (
        ALL ( Struct_MatMst[PROD_DESC] ),   -- quita filtros de producto
        [M_Rank] <= _CurrentRank            -- conserva los de rango menor-igual
    )
)

--3. % acumulado (opcional para Pareto)
M_Cumulative % =
DIVIDE (
    [M_Running Total],
    CALCULATE ( [TT Mrgn], ALL ( Struct_MatMst[PROD_DESC] ) )
)
