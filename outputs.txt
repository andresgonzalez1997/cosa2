Sku_canonico :=
VAR _byCode =
    CALCULATE (
        MAXX (
            TOPN (
                1,
                FILTER ( 'tb_equivalences_sku', 'tb_equivalences_sku'[full_code] = nis[Sku_Code] ),
                'tb_equivalences_sku'[load_date], DESC
            ),
            'tb_equivalences_sku'[full_code_new]
        )
    )
VAR _byName =
    CALCULATE (
        MAXX (
            TOPN (
                1,
                FILTER ( 'tb_equivalences_sku', 'tb_equivalences_sku'[description] = nis[product name] ),
                'tb_equivalences_sku'[load_date], DESC
            ),
            'tb_equivalences_sku'[full_code_new]
        )
    )
RETURN
COALESCE ( _byCode, _byName, nis[Sku_Code] )
