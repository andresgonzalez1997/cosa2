ValueError: Length mismatch: Expected axis has 128 elements, new values have 16 elements
ValueError                                Traceback (most recent call last)
/tmp/ipykernel_115/1215835711.py in <module>
      1 if __name__ == "__main__":
----> 2     excecute_process()

/tmp/ipykernel_115/4117894532.py in excecute_process()
     35 
     36         # Parsear (horizontal)
---> 37         df = pfh.read_file(str(local_pdf_path))
     38         print("Aqui vienen los types:-----------------")
     39         print("\n--- TIPOS DEL DATAFRAME ---")

~/competitor_data/purina_file_horizontal.py in read_file(file_path)
    129     tables     = find_tables_in_pdf(file_path)
    130     price_list = raw_price_list(tables)
--> 131     price_list = set_column_names(price_list)
    132     price_list = add_species_column(price_list)
    133     price_list = add_meta(price_list, file_path)

~/competitor_data/purina_file_horizontal.py in set_column_names(df)
     65 # ————————————————————————————————————————————————————————————
     66 def set_column_names(df):
---> 67     df.columns = H_COLUMNS
     68     return df
     69 

~/.local/lib/python3.7/site-packages/pandas/core/generic.py in __setattr__(self, name, value)
   5498         try:
   5499             object.__getattribute__(self, name)
-> 5500             return object.__setattr__(self, name, value)
   5501         except AttributeError:
   5502             pass

~/.local/lib/python3.7/site-packages/pandas/_libs/properties.pyx in pandas._libs.properties.AxisProperty.__set__()

~/.local/lib/python3.7/site-packages/pandas/core/generic.py in _set_axis(self, axis, labels)
    764     def _set_axis(self, axis: int, labels: Index) -> None:
    765         labels = ensure_index(labels)
--> 766         self._mgr.set_axis(axis, labels)
    767         self._clear_item_cache()
    768 

~/.local/lib/python3.7/site-packages/pandas/core/internals/managers.py in set_axis(self, axis, new_labels)
    214     def set_axis(self, axis: int, new_labels: Index) -> None:
    215         # Caller is responsible for ensuring we have an Index object.
--> 216         self._validate_set_axis(axis, new_labels)
    217         self.axes[axis] = new_labels
    218 

~/.local/lib/python3.7/site-packages/pandas/core/internals/base.py in _validate_set_axis(self, axis, new_labels)
     56         elif new_len != old_len:
     57             raise ValueError(
---> 58                 f"Length mismatch: Expected axis has {old_len} elements, new "
     59                 f"values have {new_len} elements"
     60             )

ValueError: Length mismatch: Expected axis has 128 elements, new values have 16 elements


-------------------------


def set_column_names(df):
    """
    Toma solo las primeras 16 columnas (las de H_COLUMNS),
    ignora el resto, y luego las renombra.
    """
    n = len(H_COLUMNS)
    if df.shape[1] < n:
        raise ValueError(f"La tabla solo tiene {df.shape[1]} columnas, se esperaban al menos {n}.")
    # Recorta a las primeras n columnas
    df_trimmed = df.iloc[:, :n].copy()
    df_trimmed.columns = H_COLUMNS
    return df_trimmed

