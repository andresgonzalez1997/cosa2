def read_file(pdf: str | pathlib.Path) -> pd.DataFrame:
    # … (pasos anteriores sin tocar)

    df = pd.concat(std_tables, ignore_index=True)

    # ❕ Elimina cabeceras/fragmentos
    df = df[~df.apply(_is_header_row, axis=1)].reset_index(drop=True)
    df.dropna(how="all", inplace=True)

    # ➜  NUEVO: mapear species y limpiar filas-categoría
    df = add_species_column(df)

    # Metadatos
    df["plant_location"] = extract_plant_location(pdf)
    df["date_inserted"]   = extract_effective_date(pdf)
    df["source"]          = pathlib.Path(pdf).name

    df = _fix_numeric(df)

    # Devuelve las 19 columnas + 3 metadatos + species (total 20)
    return df[[*COLUMN_NAMES, "species", "plant_location", "date_inserted", "source"]]
